{% extends 'shop/utils/base.html' %}
{% load cloudinary %}
{% block content %}
  {% if items %}
    <section class="cart_container">
      <div>
        <a href="{% url 'shop-home' %}"
           role="button"
           class="contrast icon_button outline">
          <svg xmlns="http://www.w3.org/2000/svg"
               width="1.5em"
               height="1.5em"
               viewBox="0 0 24 24">
            <path fill="currentColor" d="M11.03 8.53a.75.75 0 1 0-1.06-1.06l-4 4a.75.75 0 0 0 0 1.06l4 4a.75.75 0 1 0 1.06-1.06l-2.72-2.72H18a.75.75 0 0 0 0-1.5H8.31z" />
          </svg>
          Back to shop
        </a>
        <hr>
        <div class="cart__heading">
          <strong>Items: {{ order.get_item_count }}
            <br>
          Cart total: ${{ order.get_total }}</strong>
          <a href="{% url 'checkout' %}" role="button" class="icon_button">
            <svg xmlns="http://www.w3.org/2000/svg"
                 width="1.5em"
                 height="1.5em"
                 viewBox="0 0 24 24">
              <path fill="currentColor" fill-rule="evenodd" d="M7.25 7.25v-.12a4.75 4.75 0 1 1 9.5 0v.12h1.501c.571 0 1.056.419 1.14.984l.218 1.493c.43 2.938.43 5.924 0 8.862a3.135 3.135 0 0 1-2.779 2.664l-.629.065a40.7 40.7 0 0 1-8.402 0l-.629-.065a3.135 3.135 0 0 1-2.779-2.664a30.6 30.6 0 0 1 0-8.862l.219-1.493a1.15 1.15 0 0 1 1.139-.984zm3.94-3.267a3.25 3.25 0 0 1 4.06 3.147v.12h-6.5v-.12a3.25 3.25 0 0 1 2.44-3.147M7.25 8.75V11a.75.75 0 0 0 1.5 0V8.75h6.5V11a.75.75 0 0 0 1.5 0V8.75h1.2l.175 1.194a29.1 29.1 0 0 1 0 8.428a1.635 1.635 0 0 1-1.45 1.39l-.629.064c-2.69.28-5.402.28-8.092 0l-.63-.065a1.635 1.635 0 0 1-1.449-1.39a29 29 0 0 1 0-8.427L6.05 8.75z" clip-rule="evenodd" />
            </svg>
            Checkout
          </a>
        </div>
      </div>
      <div class="cart__table">
        {% for item in items %}
          <hr>
          <div class="cart__book">
            <div class="card">
              {% with item.book.image_preview as image %}
                {% cloudinary image alt=item.book loading="lazy" class="card__image" %}
              {% endwith %}
              <a href="{{ item.book.get_absolute_url }}"
                 class="card__link"
                 title="Buy {{ item.book.name }}"></a>
            </div>
            <div>
              <hgroup>
                <h5>
                  <a href="{{ item.book.get_absolute_url }}">{{ item.book.name }}</a>
                </h5>
                <p>
                  <small>{{ item.book.author }}</small>
                </p>
              </hgroup>
              <strong>${{ item.book.price }}</strong>
              <div>
                <input autocomplete="false"
                       type="number"
                       min="1"
                       data-book="{{ item.book.id }}"
                       aria-label="Quantity"
                       name="quantity-{{ item.book.id }}"
                       value="{{ item.quantity }}"
                       class="change-item" />
                <button class="contrast update-item outline"
                        data-book="{{ item.book.id }}"
                        data-place="cart"
                        data-action="delete"
                        data-tooltip="Remove from cart"
                        data-placement="left">
                  <svg xmlns="http://www.w3.org/2000/svg"
                       width="1.5em"
                       height="1.5em"
                       viewBox="0 0 24 24">
                    <path fill="currentColor" d="M10 2.25a.75.75 0 0 0-.75.75v.75H5a.75.75 0 0 0 0 1.5h14a.75.75 0 0 0 0-1.5h-4.25V3a.75.75 0 0 0-.75-.75zm0 8.4a.75.75 0 0 1 .75.75v7a.75.75 0 0 1-1.5 0v-7a.75.75 0 0 1 .75-.75m4.75.75a.75.75 0 0 0-1.5 0v7a.75.75 0 0 0 1.5 0z" />
                    <path fill="currentColor" fill-rule="evenodd" d="M5.991 7.917a.75.75 0 0 1 .746-.667h10.526a.75.75 0 0 1 .746.667l.2 1.802c.363 3.265.363 6.56 0 9.826l-.02.177a2.85 2.85 0 0 1-2.44 2.51a27 27 0 0 1-7.498 0a2.85 2.85 0 0 1-2.44-2.51l-.02-.177a44.5 44.5 0 0 1 0-9.826zm1.417.833l-.126 1.134a43 43 0 0 0 0 9.495l.02.177a1.35 1.35 0 0 0 1.157 1.191c2.35.329 4.733.329 7.082 0a1.35 1.35 0 0 0 1.157-1.19l.02-.178c.35-3.155.35-6.34 0-9.495l-.126-1.134z" clip-rule="evenodd" />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        {% endfor %}
      </section>
    {% else %}
      <div class="text center container">
        <h1>Your cart is empty</h1>
        <a href="{% url 'shop-home' %}" role="button">Start shopping</a>
      </div>
    {% endif %}
  {% endblock content %}
